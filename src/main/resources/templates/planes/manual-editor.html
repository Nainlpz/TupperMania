<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Editor de Plan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/nav :: nav}"></div>
<div class="container-fluid mt-4">
    <div class="d-flex justify-content-between mb-3">
        <h3>DiseÃ±ando: <span th:text="${plan.objetivo}" class="text-success"></span></h3>
        <a th:href="@{/planes/{id}(id=${plan.idPlan})}" class="btn btn-primary">âœ… Finalizar / Ver Resultado</a>
    </div>

    <div class="table-responsive">
        <table class="table table-bordered text-center align-middle">
            <thead class="table-dark">
            <tr>
                <th>DÃ­a</th>
                <th th:each="tipo : ${comidas}" th:text="${tipo}">COMIDA</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="dia : ${dias}">
                <td class="fw-bold bg-light" th:text="${dia}">LUNES</td>
                <td th:each="tipo : ${comidas}">
                    <div th:with="platoAsignado=${plan.platosAsignados.?[diaSemana == #root.dia && tipoComida == #root.tipo]}">

                        <div th:if="${not #lists.isEmpty(platoAsignado)}" class="p-2 bg-success-subtle rounded border border-success">
                            <strong th:text="${platoAsignado[0].plato.nombre}">Pollo</strong>
                            <br>
                            <a th:href="@{/planes/manual/seleccionar(idPlan=${plan.idPlan}, dia=${dia}, comida=${tipo})}"
                               class="btn btn-sm btn-outline-dark mt-1" style="font-size: 0.7rem;">ðŸ”„ Cambiar</a>
                        </div>

                        <div th:if="${#lists.isEmpty(platoAsignado)}">
                            <a th:href="@{/planes/manual/seleccionar(idPlan=${plan.idPlan}, dia=${dia}, comida=${tipo})}"
                               class="btn btn-sm btn-outline-secondary dashed-border">
                                âž• AÃ±adir
                            </a>
                        </div>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>